(()=>{"use strict";var e=1e-6,t="undefined"!=typeof Float32Array?Float32Array:Array;function n(){var e=new t(16);return t!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function o(e,t,n){var o=t[0],r=t[1],a=t[2],i=t[3],u=t[4],c=t[5],s=t[6],l=t[7],f=t[8],d=t[9],p=t[10],h=t[11],v=t[12],m=t[13],g=t[14],w=t[15],y=n[0],b=n[1],M=n[2],P=n[3];return e[0]=y*o+b*u+M*f+P*v,e[1]=y*r+b*c+M*d+P*m,e[2]=y*a+b*s+M*p+P*g,e[3]=y*i+b*l+M*h+P*w,y=n[4],b=n[5],M=n[6],P=n[7],e[4]=y*o+b*u+M*f+P*v,e[5]=y*r+b*c+M*d+P*m,e[6]=y*a+b*s+M*p+P*g,e[7]=y*i+b*l+M*h+P*w,y=n[8],b=n[9],M=n[10],P=n[11],e[8]=y*o+b*u+M*f+P*v,e[9]=y*r+b*c+M*d+P*m,e[10]=y*a+b*s+M*p+P*g,e[11]=y*i+b*l+M*h+P*w,y=n[12],b=n[13],M=n[14],P=n[15],e[12]=y*o+b*u+M*f+P*v,e[13]=y*r+b*c+M*d+P*m,e[14]=y*a+b*s+M*p+P*g,e[15]=y*i+b*l+M*h+P*w,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});const r=(t=1,r=[2,2,4],a=[0,0,0],i=[0,1,0])=>{const u=n(),c=n(),s=n();var l,f,d,p,h,v,m,g,w,y,b,M,P,x,U,G,S,C,A,B,R,W,F;return function(e,t,n,o,r){var a,i=1/Math.tan(t/2);e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(a=1/(o-r),e[10]=(r+o)*a,e[14]=2*r*o*a):(e[10]=-1,e[14]=-2*o)}(c,2*Math.PI/5,t,.1,100),l=u,d=a,p=i,U=(f=r)[0],G=f[1],S=f[2],C=p[0],A=p[1],B=p[2],R=d[0],W=d[1],F=d[2],Math.abs(U-R)<e&&Math.abs(G-W)<e&&Math.abs(S-F)<e?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(l):(b=U-R,M=G-W,P=S-F,h=A*(P*=x=1/Math.hypot(b,M,P))-B*(M*=x),v=B*(b*=x)-C*P,m=C*M-A*b,(x=Math.hypot(h,v,m))?(h*=x=1/x,v*=x,m*=x):(h=0,v=0,m=0),g=M*m-P*v,w=P*h-b*m,y=b*v-M*h,(x=Math.hypot(g,w,y))?(g*=x=1/x,w*=x,y*=x):(g=0,w=0,y=0),l[0]=h,l[1]=g,l[2]=b,l[3]=0,l[4]=v,l[5]=w,l[6]=M,l[7]=0,l[8]=m,l[9]=y,l[10]=P,l[11]=0,l[12]=-(h*U+v*G+m*S),l[13]=-(g*U+w*G+y*S),l[14]=-(b*U+M*G+P*S),l[15]=1),o(s,c,u),{viewMatrix:u,projectionMatrix:c,viewProjectionMatrix:s,cameraOption:{eye:r,center:a,zoomMax:100,zoomSpeed:2}}},a=()=>{return e=void 0,t=void 0,o=function*(){const e=i();if(e.includes("not support WebGPU"))throw console.log(e),"not support WebGPU";const t=document.querySelector("#canvas-webgpu"),n=yield navigator.gpu.requestAdapter();let o=yield null==n?void 0:n.requestDevice();o.lost.then((e=>{console.error(`WebGPU device was lost: ${e.message}`),o=null,"destroyed"!=e.reason&&a()}));const r=t.getContext("webgpu"),u=window.devicePixelRatio||1,c=[t.clientWidth*u,t.clientHeight*u],s=r.getPreferredFormat(n);return r.configure({device:o,format:s,size:c}),{device:o,canvas:t,context:r,presentationFormat:s}},new((n=void 0)||(n=Promise))((function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function u(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}c((o=o.apply(e,t||[])).next())}));var e,t,n,o},i=()=>{let e="Great, your current browser supports WebGPU!";return navigator.gpu||(e='Your current browser does not support WebGPU! Make sure you are on a system \n                     with WebGPU enabled. Currently, SPIR-WebGPU is only supported in  \n                     <a href="https://www.google.com/chrome/canary/">Chrome canary</a>\n                     with the flag "enable-unsafe-webgpu" enabled. See the \n                     <a href="https://github.com/gpuweb/gpuweb/wiki/Implementation-Status"> \n                     Implementation Status</a> page for more details.                   \n                    '),e};let u=null;var c,s;s=function*(){const{device:e,context:t,presentationFormat:i,canvas:c}=yield a(),s=new Float32Array([1,-1,1,1,1,0,1,1,1,1,-1,-1,1,1,0,0,1,1,0,1,-1,-1,-1,1,0,0,0,1,0,0,1,-1,-1,1,1,0,0,1,1,0,1,-1,1,1,1,0,1,1,1,1,-1,-1,-1,1,0,0,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,0,1,1,-1,-1,1,1,0,0,1,0,0,1,1,-1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,0,0,1,0,0,-1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,-1,1,1,1,0,1,0,0,-1,1,-1,1,0,1,0,1,1,0,-1,1,1,1,0,1,1,1,1,1,1,1,-1,1,1,1,0,1,0,0,-1,-1,1,1,0,0,1,1,1,1,-1,1,1,1,0,1,1,1,0,1,-1,1,-1,1,0,1,0,1,0,0,-1,-1,-1,1,0,0,0,1,1,0,-1,-1,1,1,0,0,1,1,1,1,-1,1,-1,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,1,0,1,-1,-1,1,1,0,0,1,1,0,0,-1,-1,1,1,0,0,1,1,0,0,1,-1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,0,0,1,1,1,-1,-1,-1,1,0,0,0,1,0,1,-1,1,-1,1,0,1,0,1,0,0,1,1,-1,1,1,1,0,1,1,0,1,-1,-1,1,1,0,0,1,1,1,-1,1,-1,1,0,1,0,1,0,0]),l=((e,t,n=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST)=>{const o=e.createBuffer({size:t.byteLength,usage:n,mappedAtCreation:!0});return new Float32Array(o.getMappedRange()).set(t),o.unmap(),o})(e,s),f="\n            struct VertexOutput {\n                @builtin(position) Position : vec4<f32>;\n                @location(1) vColor: vec4<f32>;\n            };\n            struct Uniforms {\n                mvpMatrix:mat4x4<f32>;\n            };\n            @binding(0) \n            @group(0) var<uniform> uniforms:Uniforms;\n            @stage(vertex)\n            fn main(@location(0) pos:vec4<f32>,\n                    @location(1) color:vec4<f32>) -> VertexOutput{   \n                var output : VertexOutput;      \n                output.Position = uniforms.mvpMatrix * pos;\n                output.vColor = color;\n                return output;\n            }\n    ",d="\n            @stage(fragment)\n            fn main(@location(1) vColor: vec4<f32>) -> @location(0) vec4<f32>{\n                return vColor;\n            }\n    ",p=e.createRenderPipeline({vertex:{module:e.createShaderModule({code:f}),entryPoint:"main",buffers:[{arrayStride:40,attributes:[{shaderLocation:0,format:"float32x4",offset:0},{shaderLocation:1,format:"float32x4",offset:16},{shaderLocation:2,format:"float32x2",offset:32}]}]},fragment:{module:e.createShaderModule({code:d}),entryPoint:"main",targets:[{format:i}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}});u=requestAnimationFrame((function(){const a=n(),i=n(),u=r(c.clientWidth/c.clientHeight).viewProjectionMatrix,s=e.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),f=e.createBindGroup({layout:p.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:s,offset:0,size:64}}]}),d=e.createCommandEncoder(),h={colorAttachments:[{view:t.getCurrentTexture().createView(),loadValue:{r:.5,g:.5,b:.8,a:1},storeOp:"store"}],depthStencilAttachment:{view:e.createTexture({size:[c.clientWidth*window.devicePixelRatio,c.clientHeight*window.devicePixelRatio,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}).createView(),depthLoadValue:1,depthStoreOp:"store",stencilLoadValue:0,stencilStoreOp:"store"}};((e,t=[0,0,0],r=[0,0,0],a=[1,1,1])=>{const i=n(),u=n(),c=n(),s=n(),l=n();var f,d;d=t,(f=s)[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=d[0],f[13]=d[1],f[14]=d[2],f[15]=1,function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(i,r[0]),function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=o,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(u,r[1]),function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=o,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(c,r[2]),function(e,t){e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(l,a),o(e,i,l),o(e,u,e),o(e,c,e),o(e,s,e)})(a),o(i,u,a),e.queue.writeBuffer(s,0,i);const v=d.beginRenderPass(h);v.setPipeline(p),v.setVertexBuffer(0,l),v.setBindGroup(0,f),v.draw(36),v.endPass(),e.queue.submit([d.finish()])}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{r(s.next(e))}catch(e){t(e)}}function o(e){try{r(s.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,o)}r((s=s.apply(void 0,[])).next())}))})();
//# sourceMappingURL=main.bundle.js.map
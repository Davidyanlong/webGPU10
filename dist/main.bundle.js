(()=>{"use strict";var e=1e-6,t="undefined"!=typeof Float32Array?Float32Array:Array;function n(){var e=new t(16);return t!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function o(e,t,n){var o=t[0],r=t[1],a=t[2],i=t[3],u=t[4],s=t[5],c=t[6],f=t[7],l=t[8],p=t[9],d=t[10],h=t[11],v=t[12],m=t[13],g=t[14],w=t[15],y=n[0],P=n[1],b=n[2],M=n[3];return e[0]=y*o+P*u+b*l+M*v,e[1]=y*r+P*s+b*p+M*m,e[2]=y*a+P*c+b*d+M*g,e[3]=y*i+P*f+b*h+M*w,y=n[4],P=n[5],b=n[6],M=n[7],e[4]=y*o+P*u+b*l+M*v,e[5]=y*r+P*s+b*p+M*m,e[6]=y*a+P*c+b*d+M*g,e[7]=y*i+P*f+b*h+M*w,y=n[8],P=n[9],b=n[10],M=n[11],e[8]=y*o+P*u+b*l+M*v,e[9]=y*r+P*s+b*p+M*m,e[10]=y*a+P*c+b*d+M*g,e[11]=y*i+P*f+b*h+M*w,y=n[12],P=n[13],b=n[14],M=n[15],e[12]=y*o+P*u+b*l+M*v,e[13]=y*r+P*s+b*p+M*m,e[14]=y*a+P*c+b*d+M*g,e[15]=y*i+P*f+b*h+M*w,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});const r=(t=1,r=[2,2,4],a=[0,0,0],i=[0,1,0])=>{const u=n(),s=n(),c=n();var f,l,p,d,h,v,m,g,w,y,P,b,M,x,U,G,S,C,A,B,R,W,F;return function(e,t,n,o,r){var a,i=1/Math.tan(t/2);e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(a=1/(o-r),e[10]=(r+o)*a,e[14]=2*r*o*a):(e[10]=-1,e[14]=-2*o)}(s,2*Math.PI/5,t,.1,100),f=u,p=a,d=i,U=(l=r)[0],G=l[1],S=l[2],C=d[0],A=d[1],B=d[2],R=p[0],W=p[1],F=p[2],Math.abs(U-R)<e&&Math.abs(G-W)<e&&Math.abs(S-F)<e?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(f):(P=U-R,b=G-W,M=S-F,h=A*(M*=x=1/Math.hypot(P,b,M))-B*(b*=x),v=B*(P*=x)-C*M,m=C*b-A*P,(x=Math.hypot(h,v,m))?(h*=x=1/x,v*=x,m*=x):(h=0,v=0,m=0),g=b*m-M*v,w=M*h-P*m,y=P*v-b*h,(x=Math.hypot(g,w,y))?(g*=x=1/x,w*=x,y*=x):(g=0,w=0,y=0),f[0]=h,f[1]=g,f[2]=P,f[3]=0,f[4]=v,f[5]=w,f[6]=b,f[7]=0,f[8]=m,f[9]=y,f[10]=M,f[11]=0,f[12]=-(h*U+v*G+m*S),f[13]=-(g*U+w*G+y*S),f[14]=-(P*U+b*G+M*S),f[15]=1),o(c,s,u),{viewMatrix:u,projectionMatrix:s,viewProjectionMatrix:c,cameraOption:{eye:r,center:a,zoomMax:100,zoomSpeed:2}}},a=()=>{return e=void 0,t=void 0,o=function*(){const e=i();if(e.includes("not support WebGPU"))throw console.log(e),"not support WebGPU";const t=document.querySelector("#canvas-webgpu"),n=yield navigator.gpu.requestAdapter();let o=yield null==n?void 0:n.requestDevice();o.lost.then((e=>{console.error(`WebGPU device was lost: ${e.message}`),o=null,"destroyed"!=e.reason&&a()}));const r=t.getContext("webgpu"),u=window.devicePixelRatio||1,s=[t.clientWidth*u,t.clientHeight*u],c=r.getPreferredFormat(n);return r.configure({device:o,format:c,size:s}),{device:o,canvas:t,context:r,presentationFormat:c}},new((n=void 0)||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function u(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}s((o=o.apply(e,t||[])).next())}));var e,t,n,o},i=()=>{let e="Great, your current browser supports WebGPU!";return navigator.gpu||(e='Your current browser does not support WebGPU! Make sure you are on a system \n                     with WebGPU enabled. Currently, SPIR-WebGPU is only supported in  \n                     <a href="https://www.google.com/chrome/canary/">Chrome canary</a>\n                     with the flag "enable-unsafe-webgpu" enabled. See the \n                     <a href="https://github.com/gpuweb/gpuweb/wiki/Implementation-Status"> \n                     Implementation Status</a> page for more details.                   \n                    '),e};let u=null;var s,c;c=function*(){const{device:e,context:t,presentationFormat:i,canvas:s}=yield a(),c=new Float32Array([1,-1,1,1,1,0,1,1,1,1,-1,-1,1,1,0,0,1,1,0,1,-1,-1,-1,1,0,0,0,1,0,0,1,-1,-1,1,1,0,0,1,1,0,1,-1,1,1,1,0,1,1,1,1,-1,-1,-1,1,0,0,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,0,1,1,-1,-1,1,1,0,0,1,0,0,1,1,-1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,0,0,1,0,0,-1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,-1,1,1,1,0,1,0,0,-1,1,-1,1,0,1,0,1,1,0,-1,1,1,1,0,1,1,1,1,1,1,1,-1,1,1,1,0,1,0,0,-1,-1,1,1,0,0,1,1,1,1,-1,1,1,1,0,1,1,1,0,1,-1,1,-1,1,0,1,0,1,0,0,-1,-1,-1,1,0,0,0,1,1,0,-1,-1,1,1,0,0,1,1,1,1,-1,1,-1,1,0,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,0,1,1,1,0,1,-1,-1,1,1,0,0,1,1,0,0,-1,-1,1,1,0,0,1,1,0,0,1,-1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,0,0,1,1,1,-1,-1,-1,1,0,0,0,1,0,1,-1,1,-1,1,0,1,0,1,0,0,1,1,-1,1,1,1,0,1,1,0,1,-1,-1,1,1,0,0,1,1,1,-1,1,-1,1,0,1,0,1,0,0]),f=((e,t,n=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST)=>{const o=e.createBuffer({size:t.byteLength,usage:n,mappedAtCreation:!0});return new Float32Array(o.getMappedRange()).set(t),o.unmap(),o})(e,c),l="\n            struct VertexOutput {\n                @builtin(position) Position : vec4<f32>;\n                @location(1) vColor: vec4<f32>;\n            };\n            struct Uniforms {\n                mvpMatrix:mat4x4<f32>;\n            };\n            @binding(0) \n            @group(0) var<uniform> uniforms:Uniforms;\n            @stage(vertex)\n            fn main(@location(0) pos:vec4<f32>,\n                    @location(1) color:vec4<f32>) -> VertexOutput{   \n                var output : VertexOutput;      \n                output.Position = uniforms.mvpMatrix * pos;\n                output.vColor = color;\n                return output;\n            }\n    ",p="\n            @stage(fragment)\n            fn main(@location(1) vColor: vec4<f32>) -> @location(0) vec4<f32>{\n                return vColor;\n            }\n    ",d=e.createRenderPipeline({vertex:{module:e.createShaderModule({code:l}),entryPoint:"main",buffers:[{arrayStride:40,attributes:[{shaderLocation:0,format:"float32x4",offset:0},{shaderLocation:1,format:"float32x4",offset:16},{shaderLocation:2,format:"float32x2",offset:32}]}]},fragment:{module:e.createShaderModule({code:p}),entryPoint:"main",targets:[{format:i}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}});u=requestAnimationFrame((function(){const a=n(),i=n(),u=r(s.clientWidth/s.clientHeight).viewProjectionMatrix,c=e.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),l=e.createBindGroup({layout:d.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:c,offset:0,size:64}}]}),p=e.createCommandEncoder(),h={colorAttachments:[{view:t.getCurrentTexture().createView(),loadValue:{r:.5,g:.5,b:.8,a:1},storeOp:"store"}],depthStencilAttachment:{view:e.createTexture({size:[s.clientWidth*window.devicePixelRatio,s.clientHeight*window.devicePixelRatio,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}).createView(),depthLoadValue:1,depthStoreOp:"store",stencilLoadValue:0,stencilStoreOp:"store"}};((e,t=[0,0,0],r=[0,0,0],a=[1,1,1])=>{const i=n(),u=n(),s=n(),c=n(),f=n();var l,p;p=t,(l=c)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=p[0],l[13]=p[1],l[14]=p[2],l[15]=1,function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(i,r[0]),function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=o,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(u,r[1]),function(e,t){var n=Math.sin(t),o=Math.cos(t);e[0]=o,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(s,r[2]),function(e,t){e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(f,a),o(e,i,f),o(e,u,e),o(e,s,e),o(e,c,e)})(a),o(i,u,a),e.queue.writeBuffer(c,0,i);const v=p.beginRenderPass(h);v.setPipeline(d),v.setVertexBuffer(0,f),v.setBindGroup(0,l),v.draw(36),v.endPass(),e.queue.submit([p.finish()])}))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(n,o)}r((c=c.apply(void 0,[])).next())}))})();
//# sourceMappingURL=main.bundle.js.map